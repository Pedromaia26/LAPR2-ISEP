@startuml
actor Administrator as Adm
participant ":RegistEmployeeUI" as Interface
participant ":RegistEmployeeController" as Controller
participant ":Company" as Company
participant ":RolesMapper" as RolesMapper
participant "store \n :EmployeeStore" as estore
participant "empDto: EmployeeDto" as EmployeeDto
participant "store \n :RolesStore" as rstore
participant "role:OrgRole" as OrgRole


autonumber
activate Adm
Adm -> Interface: starts registering a new employee
activate Interface
Interface -> Controller: IRolesDto = getRoles()
activate Controller
Controller -> rstore: lRoles = getRoles()
activate rstore
deactivate rstore
Controller -> RolesMapper: lRolesDto = toDTO(lRoles)
activate RolesMapper
deactivate RolesMapper
deactivate Controller
Interface --> Adm: ask to select the employee role
deactivate Interface
Adm -> Interface: selects the intended role
activate Interface
Interface --> Adm: request data (name, address, phoneNumber, emailAddress, socCode)
opt role = Specialist Doctor
    Interface --> Adm: request data(doctorIndexNumber)
end
deactivate Interface


Adm -> Interface: types requested data
activate Interface
Interface --> Controller: createEmployee(empDto)
activate Controller
Controller -> estore: emp = createEmployee(empDto)
activate estore
estore -> EmployeeDto: roleId = getRoleId()
activate EmployeeDto
deactivate EmployeeDto
estore -> rstore: role = getRoleById(roleId)
activate rstore
deactivate rstore
estore -> EmployeeDto: id = getId()
activate EmployeeDto
deactivate EmployeeDto
estore -> EmployeeDto: name = getName()
activate EmployeeDto
deactivate EmployeeDto
estore -> EmployeeDto: adress = getAdress()
activate EmployeeDto
deactivate EmployeeDto
estore -> EmployeeDto: phoneNumber = getphoneNumber()
activate EmployeeDto
deactivate EmployeeDto
estore -> EmployeeDto: emailAdress = getEmailAdress()
activate EmployeeDto
deactivate EmployeeDto
estore -> EmployeeDto: socCode = getsocCode()
activate EmployeeDto
deactivate EmployeeDto
alt role != SpecialistDoctor
    estore -> OrgRole: emp = createEmployee(role, id, name, address, phoneNumber, emailAddress, socCode)
    activate OrgRole
else
    estore -> EmployeeDto: doctorIndexNumber = getDoctorIndexNumber()
    activate EmployeeDto
    deactivate EmployeeDto
    estore -> OrgRole: emp = createEmployee(role, id, name, address, phoneNumber, emailAddress, socCode, doctorIndexNumber)
end
alt role != SpecialistDoctor
    create "emp:Employee" as Employee
    OrgRole -> Employee: create(role, id, name, address, phoneNumber, emailAddress, socCode)
else
    create "emp:SpecialistDoctor" as Doctor
    OrgRole -> Doctor:create(role, id, name, address, phoneNumber, emailAddress, socCode, doctorIndexNumber)
end
deactivate OrgRole
deactivate estore
Controller -> estore: validateEmployee(emp)
activate estore
deactivate estore
deactivate Controller

Interface -> Adm: shows the data and requests a confirmation
deactivate Interface
Adm -> Interface: confirms the data

activate Interface
Interface -> Controller: saveEmployee()
activate Controller
Controller -> estore: saveEmployee(emp)
activate estore
estore -> estore: validateEmployee(emp)
activate estore
deactivate estore
estore -> estore: addEmployee(emp)
activate estore
deactivate estore
deactivate estore
deactivate Controller
Interface -> Adm: informs operation success
deactivate Interface
deactivate Adm
@enduml